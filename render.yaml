services:
  - type: web
    name: glchemtec-openwebui
    env: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    plan: standard
    region: oregon
    healthCheckPath: /health
    autoDeploy: true
    envVars:
      - key: OPENAI_API_KEY
        sync: false
      - key: MICROSOFT_CLIENT_ID
        sync: false
      - key: MICROSOFT_CLIENT_SECRET
        sync: false
      - key: MICROSOFT_TENANT_ID
        sync: false
      - key: WEBUI_NAME
        value: GLChemTec OpenWebUI
      - key: WEBUI_AUTH
        value: "true"
      - key: ENABLE_OAUTH_SIGNUP
        value: "true"
      - key: ENABLE_LOGIN_FORM
        value: "true"
      - key: ENABLE_PASSWORD_AUTH
        value: "true"
      - key: WEBUI_URL
        fromService:
          type: web
          name: glchemtec-openwebui
          property: host
      - key: MICROSOFT_REDIRECT_URI
        fromService:
          type: web
          name: glchemtec-openwebui
          property: host
          suffix: /oauth/microsoft/callback
      - key: WEBUI_SECRET_KEY
        sync: false
      - key: OPENID_PROVIDER_URL
        sync: false
      - key: CORS_ALLOW_ORIGIN
        value: ""
      - key: ENABLE_OAUTH_PERSISTENT_CONFIG
        value: "true"
      - key: MICROSOFT_OAUTH_SCOPE
        value: "openid email profile"
      - key: WEBUI_ADMIN_EMAIL
        value: "haron@glchemtec.ca"
      - key: WEBUI_ADMIN_PASSWORD
        sync: false
      # Document/File Processing Settings
      - key: RAG_EMBEDDING_MODEL
        value: "text-embedding-3-small"
      - key: ENABLE_RAG_WEB_SEARCH
        value: "false"
      - key: PDF_EXTRACT_IMAGES
        value: "true"
      - key: RAG_FILE_MAX_SIZE
        value: "100"
      - key: RAG_FILE_MAX_COUNT
        value: "10"
      - key: USER_PERMISSIONS_CHAT_FILE_UPLOAD
        value: "true"
      - key: DEFAULT_USER_ROLE
        value: "user"
